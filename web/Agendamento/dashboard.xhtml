<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:b="http://bootsfaces.net/ui">

    <ui:composition template="../template.xhtml">
        <ui:define name="titulo"  >
            <span style="margin-left: 10px; font-size: 22px; font-family: sans-serif; color: #999999 ; "> Agendamentos </span>
        </ui:define>
        <ui:define name="conteudo">
            <h:form id="dashboard" >
                <div class="col-md-12" style="margin-top: 5px">          
                    <div class="form-group"> 
                        <h:commandButton id="novoEvento" value="Agendar" class="btn btn-primary">
                            <p:ajax oncomplete="PF('dialogNovoEvento').show();" update=":dashboard:panelNovoEvento" />
                        </h:commandButton>
                    </div>
                </div>

                <div id="teste" class="row" style="margin-top: 0px;">
                    <center>
                        <table border="0" width="50%">
                            <tr style="width: 5%" >
                                <ui:repeat value="#{salaController.todosVisiveis()}" var="s" varStatus="status" >
                                    <td>  
                                        <p > 
                                            <h:commandButton disabled="true" style="background-color: #{s.cor} ; width: 10px; height: 15px; border-radius: 3px; border: 0 " /> #{s.nome_sala}
                                        </p>
                                    </td> 
                                </ui:repeat>
                            </tr>
                        </table>
                    </center>
                    <p:dataTable id="table_agenda"
                                 widgetVar="w_table_agenda"
                                 value="#{agendamentoController.todos()}" 
                                 var="s"
                                 rowIndexVar="rowIx"
                                 style="width: 100%; margin: 0 auto" 
                                 sortBy="#{s.inicio}"
                                 sortOrder="descending" >
                        <p:column headerText=" " styleClass="#{agendamentoController.cor_evento(s.sala.cor)}" style="width: 1%;"  />
                        <p:column headerText="Sala/Local"  style="text-align:center; vertical-align: middle;">#{s.sala.nome_sala}</p:column>
                        <p:column headerText="Titulo" style="text-align:center; vertical-align: middle;">#{s.titulo}</p:column>
                        <p:column headerText="Início" style="text-align:center; vertical-align: middle;">
                            <h:outputText value="#{s.inicio}" >
                                <f:convertDateTime timeZone="GMT-3" pattern="dd/MM/yyyy HH:mm" />
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Fim" style="text-align:center; vertical-align: middle;">
                            <h:outputText value="#{s.fim}">
                                <f:convertDateTime timeZone="GMT-3" pattern="dd/MM/yyyy HH:mm" />
                            </h:outputText>
                        </p:column>
                        <p:column headerText="QTD Pessoas" style="text-align:center; vertical-align: middle; width: 10%">#{s.descritivo.qtd_pessoas}</p:column>
                        <p:column headerText="Adicionais" style="text-align:center; vertical-align: middle;">#{s.descritivo.agua? 'Água':''} #{s.descritivo.cafe? 'Café':''} #{s.descritivo.frutas? 'Frutas':''}</p:column>
                        <p:column style="text-align:center; vertical-align: middle; width: 5%;">
                            <h:commandLink class="btn btn-default"  onclick="PF('dialogNovoEvento').show();" value="" >
                                <h:graphicImage value="/Imagem/icons/editar.png" />
                                <f:ajax event="click" listener="#{agendamentoController.editarPorDashboard(s)}" render=":dashboard:panelNovoEvento"/>
                            </h:commandLink>
                        </p:column>
                        <p:column style="text-align:center; vertical-align: middle; width: 5%">
                            <h:commandLink class="btn btn-primary"  onclick="PF('dialogDetalhesEvento').show();" value="" >
                                <h:graphicImage value="/Imagem/icons/lupa.png" />
                                <f:ajax event="click" listener="#{agendamentoController.editarPorDashboard(s)}" render=":dashboard:panelDetalhesEvento" />
                            </h:commandLink>
                        </p:column>
                    </p:dataTable>
                </div> 
                <p:dialog  widgetVar="dialogNovoEvento"  maximizable="false" header="Adicionar Evento" showEffect="clip" hideEffect="clip" closable="true" draggable="true" modal="true" resizable="true"   >
                    <h:panelGrid id="panelNovoEvento" columns="1" style="width: 300px;" >
                        <ui:include src="agendamento.xhtml" />
                    </h:panelGrid>
                </p:dialog>

                <p:dialog  widgetVar="dialogDetalhesEvento"  maximizable="false" header="Detalhes" showEffect="clip" hideEffect="clip" closable="true" draggable="true" modal="true" resizable="true"   >
                    <h:panelGrid id="panelDetalhesEvento" columns="1" style="width: 300px;" >
                        <h:panelGrid columns="2" > 
                            <h:outputLabel value="Título: " />
                            <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.titulo}" /> 

                            <h:outputLabel value="Sala/Local: " />
                            <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.sala.nome_sala}" /> 

                            <h:outputLabel value="Início: " />
                            <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.inicio}" >
                                <f:convertDateTime timeZone="GMT-3" pattern="dd/MM/yyyy HH:mm" />
                            </h:outputLabel>

                            <h:outputLabel value="Fim: " />
                            <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.fim}" >
                                <f:convertDateTime timeZone="GMT-3" pattern="dd/MM/yyyy HH:mm" />
                            </h:outputLabel>

                            <h:outputLabel value="QTD: " />
                            <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.descritivo.qtd_pessoas}" /> 

                            <h:outputLabel value="Adicionais: " />
                            <h:panelGrid columns="1">
                                <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.descritivo.agua? 'Água':''}" />
                                <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.descritivo.cafe? 'Café':''}" />
                                <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.descritivo.frutas? 'Frutas':''}" />
                            </h:panelGrid>

                            <h:outputLabel value="Observação: " />
                            <h:outputLabel style="font-weight: 100" value="#{agendamentoController.agendamento.descritivo.adicional}" />
                        </h:panelGrid>
                    </h:panelGrid>
                </p:dialog>
            </h:form>
        </ui:define>      
    </ui:composition>
</html>
